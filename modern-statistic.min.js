!function(t,i,e){XF.BRMSContainer=XF.Element.newHandler({options:{},$clone:null,created:!1,init:function(){$container=this.$target,this.$container=$container;var e=$container.attr("data-previewType"),a=parseInt($container.attr("data-allowCusItemLimit")),n=parseInt($container.attr("data-allowCusLayout")),s=$container.attr("data-useLimit"),r=$container.attr("data-entryLimit"),o=$container.attr("data-navPosition"),l=parseInt($container.attr("data-updateInterval")),d=parseInt($container.attr("data-modernStatisticId"));this.$containerClass="BRMSContainer ",$container.hasClass("BRMSContainerDark")&&(this.$containerClass="BRMSContainer BRMSContainerDark "),this.$previewType=e,this.$allowCusItemLimit=a,this.$allowCusLayout=n,this.$entryLimit=r,this.$navPosition=o,this.$updateIntervalTime=l,this.$modernStatisticId=d,this.$hardReload=!1;var h=XF.Cookie.get("brmsLayoutChange"+d);n&&h&&($container.removeClass("brmsTopTabs brmsRightTabs brmsLeftTabs"),$container.addClass(h)),s&&parseInt(s)>0?(this.$entryLimit=s,$container.attr("data-entryLimit",s)):this.$allowCusItemLimit&&XF.Cookie.get("brmsNumberEntry"+d)&&(this.$entryLimit=XF.Cookie.get("brmsNumberEntry"+d),$container.attr("data-entryLimit",this.$entryLimit));var c=$container.find("ul.brmsTabNav > li").length-2;$container.find("ul.brmsTabNav > li:first").addClass("first"),$container.find("ul.brmsTabNav > li:eq("+c+")").addClass("last"),$container.find("ul.brmsTabNav > li > a, .brmsTabNavHidden  ul.brmsDropdownMenu  > li > a").click(XF.proxy(this,"navTabTriggerHandle")),this.showTab($container.find(".brmsTabContent:first").data("content")),this.updateInterval(),$container.find(".brmsNumberEntry").click(XF.proxy(this,"numberEntryChangeHandle")),$container.find(".brmsLayoutChange").click(XF.proxy(this,"layoutChangeHandle")),$container.find(".brmsRefresh").click(XF.proxy(this,"refreshHandle")),this.responsiveInit(),t(i).resize(XF.proxy(this,"responsiveInit")),$container.find(".brmsDropdownToggle").hover(function(i){var e=t(this).find("ul.brmsDropdownMenu");e.show(),e.offset().left+e.width()>$container.width()?e.addClass("edge"):e.removeClass("edge"),"none"!=e.css("display")&&e.offset().left<=0&&e.css({left:0})},function(i){var e=t(this).find("ul.brmsDropdownMenu");t(this).find("ul.brmsDropdownMenu").hide(),e.offset().left+e.width()>$container.width()?e.addClass("edge"):e.removeClass("edge"),"none"!=e.css("display")&&e.offset().left<=0&&e.css({left:0})}),$container.find(".brmsDropdownToggle").click(function(i){t(this).find("ul.brmsDropdownMenu").toggle()})},navTabTriggerHandle:function(i){i.preventDefault();var e=this.$container,a=t(i.target);a.attr("data-content")||(a=a.closest("a"));var n=a.closest("li");if(n&&!n.hasClass("current")){e.find("ul.brmsTabNav > li , .brmsTabNavHidden  ul.brmsDropdownMenu  > li").removeClass("current"),a.closest("li").addClass("current");var s=a.attr("data-content");e.find("."+s).find(".brmsIcoLoader").length&&this.getStatistics(a.attr("data-tabid"),0),e.find(".brmsTabContent").hide().removeClass("current"),e.find("."+s).fadeIn(100).addClass("current"),this.responsiveInit()}},numberEntryChangeHandle:function(i){i.preventDefault();var e=this.$container,a=t(i.target).attr("data-limit");a&&(this.$entryLimit=a,e.attr("data-entryLimit",a),XF.Cookie.set("brmsNumberEntry"+this.$modernStatisticId,a),this.resetInterval(),this.$hardReload=1,this.runInterval(),this.$hardReload=!1)},layoutChangeHandle:function(i){i.preventDefault();var e=this.$container,a=t(i.target).attr("data-layout");a&&(e.hasClass(a)||(e.removeClass("brmsTopTabs brmsRightTabs brmsLeftTabs"),e.addClass(a)),XF.Cookie.set("brmsLayoutChange"+this.$modernStatisticId,a),this.responsiveInit())},refreshHandle:function(i){i.preventDefault();var e=t(i.target);e.hasClass("disable")||(this.resetInterval(),this.$hardReload=1,e.addClass("disable"),this.runInterval(),this.$hardReload=!1)},getStatistics:function(t,i){this.$container;var e=this.$modernStatisticId,a=this;i||(i=a.$entryLimit),XF.ajax("post",XF.canonicalizeUrl("/brms-statistics/load-tab"),{tab_id:t,modern_statistic_id:e,hard_reload:a.$hardReload,limit:i},XF.proxy(a,"showResult"),{cache:!1}).always(function(){a.$entryLimit=0})},showResult:function(t){var i=this.$container;if(!t.errors&&!t.exception){var e=this;XF.setupHtmlInsert(t.tabContentHtml,function(a,n,s){a?e.$container.find(".brmsTabContent_"+t.tabId).html(a):e.$container.find(".brmsTabContent_"+t.tabId).html(""),s(),XF.activate(i),e.$container.find(".brmsRefresh").removeClass("disable"),e.responsiveInit()}),t.limit&&i.attr("data-entryLimit",t.limit)}},showTab:function(t){var i=this.$container;t?(i.find("ul.brmsTabNav > li > a[data-content='"+t+"']").trigger("click"),t.replace("brmsTabContent_","")):(i.find("ul.brmsTabNav > li.current a").trigger("click"),i.find("ul.brmsTabNav > li.current a").attr("data-content").replace("brmsTabContent_",""))},runInterval:function(){var t=this.$container;this.getStatistics(t.find("li.brmlShow.current a").data("tabid"),this.$entryLimit)},updateInterval:function(){if(!this.$brmsActive){var t=this.$container,e=this.$updateIntervalTime,a=this;if(e>0)return this.$brmsActive=i.setInterval(function(){a.getStatistics(t.find("ul.brmsTabNav > li.current a").data("tabid"),a.$entryLimit)},1e3*e),this.$brmsActive}},clearInterval:function(){i.clearInterval(this.$brmsActive),this.$brmsActive=!1,this.$updateIntervalTime=0},resetInterval:function(){this.clearInterval(),this.updateInterval()},responsiveInit:function(){var i=this.$container;if(i.find(".brmsTabContent.current").length){var e=i.find(".brmsLayoutList");if(i.hasClass("brmsTopTabs")){var a=0,n=i.find(".brmsStatisticHeader").width()-i.find(".brmsConfigList").width()-75,s=!1;i.find(".brmsTabNav > li.brmlShow").each(function(){var e=i.find(".brmsTabNavHidden li:eq("+t(this).index()+")");a+t(this).width()<=n?(a+=t(this).width(),t(this).css({display:"block"}),e.hasClass("current")&&(t(this).addClass("current"),e.removeClass("current")),e.css({display:"none"})):(s=!0,t(this).css({display:"none"}),t(this).hasClass("current")&&(t(this).removeClass("current"),e.addClass("current")),e.css({display:"block"}))});var r=i.find(".brmsTabNavHiddenMenu");s?r.show():r.hide(),i.width()>480?(XF.Cookie.get("brmsLayoutChange"+this.$modernStatisticId)&&!i.hasClass(XF.Cookie.get("brmsLayoutChange"+this.$modernStatisticId))&&i.attr("class",this.$containerClass+XF.Cookie.get("brmsLayoutChange"+this.$modernStatisticId)),e.css({display:"inline-block"})):e.css({display:"none"})}else i.width()<=480&&(i.attr("class",this.$containerClass+" brmsTopTabs"),e.css({display:"none"}));var o=i.find(".brmsTabContent.current ol li.itemStast");if(i.find(".brmsTabContent.current").width()<550)o.hasClass("itemUser")||o.hasClass("itemProfilePost")?(o.find(".itemDetail.itemSubDetail").hide(),o.find(".itemTitle").css({"max-width":"75%"}),i.find(".brmsTabContent.current").width()<350?(o.find(".itemDetail.itemDetailMain span").hide(),o.find(".itemDetail.itemDetailMain").css({width:"50px"}),o.find(".itemDetail.itemDetailMain.itemDate").css({width:"90px"}),o.find(".itemTitle").css({"max-width":"85%"})):(o.find(".itemDetail.itemDetailMain span, .itemDetail.itemDetailMain strong").show(),o.find(".itemDetail.itemDetailMain").css({width:"200px"}),o.find(".itemTitle").css({"max-width":"75%"}))):(o.find(".itemDetail").hide(),o.find(".itemTitle").css({"max-width":"90%"}),i.find(".brmsTabContent.current").width(),o.find(".prefix").show());else{o.find(".prefix").show(),o.find(".itemDetail").show(),o.find(".itemTitle").css({width:"auto"}),o.find(".itemDetail.itemDetailMain span").show(),o.find(".itemDetail.itemDetailMain").css({width:"150px"}),o.find(".itemDetail.itemDetailMain.itemDate").css({width:"200px"});var l=parseInt(.33*o.width()),d=o.find(".itemTitle").width();o.find(".itemSubDetail").each(function(i){"none"==t(this).css("display")?d-150>l&&o.find(".itemSubDetail:eq("+i+")").show():d<l&&o.find(".itemSubDetail:eq("+i+")").hide()})}}},getText:function(t,i){return BRMSLANG.xf[t]||i}}),XF.BRMSTooltip=XF.Element.newHandler({options:{},$parent:null,init:function(){this.$parent=this.$target.closest(".BRMSToolTip");this.$parent.hover(XF.proxy(this,"showTooltip"),XF.proxy(this,"hideTooltip"))},showTooltip:function(){var i=this.$parent.find(".tooltip");i.length||(i=t(this.toolTips())).insertBefore(this.$target),i.addClass("show")},hideTooltip:function(){var t=this.$parent.find(".tooltip");t.length&&t.removeClass("show")},toolTips:function(){let t;var i=this.$target;if("resource"==i.attr("data-kind")&&i.attr("data-box")?t="<div>["+this.getText("brms_category")+"] : <b>"+i.attr("data-box")+'</b></div><ul class="listInline listInline--bullet"><li>'+this.getText("brms_download")+": <b>"+i.attr("data-download")+"</b> </li><li>"+this.getText("brms_update")+": <b>"+i.attr("data-update")+"</b> </li><li>"+this.getText("brms_review")+": <b>"+i.attr("data-review")+"</b> </li><li>"+this.getText("brms_rating")+": <b>"+i.attr("data-vote")+"</b> </li></ul></div>":i.attr("data-box")&&(t="<div>["+this.getText("brms_forum")+"] : <b>"+i.attr("data-box")+'</b></div><ul class="listInline listInline--bullet"><li>'+this.getText("brms_views")+": <b>"+i.attr("data-view")+"</b> </li><li>"+this.getText("brms_replies")+": <b>"+i.attr("data-rep")+"</b> </li><li>"+this.getText("brms_likes")+": <b>"+i.attr("data-like")+"</b> </li></ul></div>"),t)return'<div class="tooltip tooltip--basic tooltip--top" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-content">'+t+"</div></div>"},getText:function(t,i){return XF.phrases[t]||i}}),XF.Element.register("brms-container","XF.BRMSContainer"),XF.Element.register("brms-tooltip","XF.BRMSTooltip")}(jQuery,window,document);
